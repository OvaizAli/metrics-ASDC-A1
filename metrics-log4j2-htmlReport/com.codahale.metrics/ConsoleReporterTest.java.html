<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ConsoleReporterTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">All in metrics-log4j2 Coverage Results</a> &gt; <a href="index.source.html" class="el_package">com.codahale.metrics</a> &gt; <span class="el_source">ConsoleReporterTest.java</span></div><h1>ConsoleReporterTest.java</h1><pre class="source lang-java linenums">package com.codahale.metrics;

import org.apache.commons.lang3.JavaVersion;
import org.apache.commons.lang3.SystemUtils;
import org.junit.Before;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.PrintStream;
import java.io.UnsupportedEncodingException;
import java.util.EnumSet;
import java.util.Locale;
import java.util.Set;
import java.util.SortedMap;
import java.util.TimeZone;
import java.util.TreeMap;
import java.util.concurrent.TimeUnit;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

<span class="nc" id="L23">public class ConsoleReporterTest {</span>
<span class="nc" id="L24">    private final Locale locale = Locale.US;</span>
<span class="nc" id="L25">    private final TimeZone timeZone = TimeZone.getTimeZone(&quot;America/Los_Angeles&quot;);</span>

<span class="nc" id="L27">    private final MetricRegistry registry = mock(MetricRegistry.class);</span>
<span class="nc" id="L28">    private final Clock clock = mock(Clock.class);</span>
<span class="nc" id="L29">    private final ByteArrayOutputStream bytes = new ByteArrayOutputStream();</span>
<span class="nc" id="L30">    private final PrintStream output = new PrintStream(bytes);</span>
<span class="nc" id="L31">    private final ConsoleReporter reporter = ConsoleReporter.forRegistry(registry)</span>
<span class="nc" id="L32">            .outputTo(output)</span>
<span class="nc" id="L33">            .formattedFor(locale)</span>
<span class="nc" id="L34">            .withClock(clock)</span>
<span class="nc" id="L35">            .formattedFor(timeZone)</span>
<span class="nc" id="L36">            .convertRatesTo(TimeUnit.SECONDS)</span>
<span class="nc" id="L37">            .convertDurationsTo(TimeUnit.MILLISECONDS)</span>
<span class="nc" id="L38">            .filter(MetricFilter.ALL)</span>
<span class="nc" id="L39">            .build();</span>
    private String dateHeader;

    @Before
    public void setUp() throws Exception {
<span class="nc" id="L44">        when(clock.getTime()).thenReturn(1363568676000L);</span>
        // JDK9 has changed the java.text.DateFormat API implementation according to Unicode.
        // See http://mail.openjdk.java.net/pipermail/jdk9-dev/2017-April/005732.html
<span class="nc bnc" id="L47" title="All 2 branches missed.">        dateHeader = SystemUtils.isJavaVersionAtMost(JavaVersion.JAVA_1_8) ?</span>
<span class="nc" id="L48">                &quot;3/17/13 6:04:36 PM =============================================================&quot; :</span>
                // https://bugs.openjdk.org/browse/JDK-8304925
<span class="nc bnc" id="L50" title="All 2 branches missed.">                SystemUtils.isJavaVersionAtLeast(JavaVersion.JAVA_20) ?</span>
<span class="nc" id="L51">                        &quot;3/17/13, 6:04:36\u202FPM ============================================================&quot; :</span>
<span class="nc" id="L52">                        &quot;3/17/13, 6:04:36 PM ============================================================&quot;;</span>
<span class="nc" id="L53">    }</span>

    @Test
    public void reportsGaugeValues() throws Exception {
<span class="nc" id="L57">        final Gauge&lt;Integer&gt; gauge = () -&gt; 1;</span>

<span class="nc" id="L59">        reporter.report(map(&quot;gauge&quot;, gauge),</span>
<span class="nc" id="L60">                map(),</span>
<span class="nc" id="L61">                map(),</span>
<span class="nc" id="L62">                map(),</span>
<span class="nc" id="L63">                map());</span>

<span class="nc" id="L65">        assertThat(consoleOutput())</span>
<span class="nc" id="L66">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Gauges ----------------------------------------------------------------------&quot;,
                        &quot;gauge&quot;,
                        &quot;             value = 1&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L75">    }</span>

    @Test
    public void reportsCounterValues() throws Exception {
<span class="nc" id="L79">        final Counter counter = mock(Counter.class);</span>
<span class="nc" id="L80">        when(counter.getCount()).thenReturn(100L);</span>

<span class="nc" id="L82">        reporter.report(map(),</span>
<span class="nc" id="L83">                map(&quot;test.counter&quot;, counter),</span>
<span class="nc" id="L84">                map(),</span>
<span class="nc" id="L85">                map(),</span>
<span class="nc" id="L86">                map());</span>

<span class="nc" id="L88">        assertThat(consoleOutput())</span>
<span class="nc" id="L89">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Counters --------------------------------------------------------------------&quot;,
                        &quot;test.counter&quot;,
                        &quot;             count = 100&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L98">    }</span>

    @Test
    public void reportsHistogramValues() throws Exception {
<span class="nc" id="L102">        final Histogram histogram = mock(Histogram.class);</span>
<span class="nc" id="L103">        when(histogram.getCount()).thenReturn(1L);</span>

<span class="nc" id="L105">        final Snapshot snapshot = mock(Snapshot.class);</span>
<span class="nc" id="L106">        when(snapshot.getMax()).thenReturn(2L);</span>
<span class="nc" id="L107">        when(snapshot.getMean()).thenReturn(3.0);</span>
<span class="nc" id="L108">        when(snapshot.getMin()).thenReturn(4L);</span>
<span class="nc" id="L109">        when(snapshot.getStdDev()).thenReturn(5.0);</span>
<span class="nc" id="L110">        when(snapshot.getMedian()).thenReturn(6.0);</span>
<span class="nc" id="L111">        when(snapshot.get75thPercentile()).thenReturn(7.0);</span>
<span class="nc" id="L112">        when(snapshot.get95thPercentile()).thenReturn(8.0);</span>
<span class="nc" id="L113">        when(snapshot.get98thPercentile()).thenReturn(9.0);</span>
<span class="nc" id="L114">        when(snapshot.get99thPercentile()).thenReturn(10.0);</span>
<span class="nc" id="L115">        when(snapshot.get999thPercentile()).thenReturn(11.0);</span>

<span class="nc" id="L117">        when(histogram.getSnapshot()).thenReturn(snapshot);</span>

<span class="nc" id="L119">        reporter.report(map(),</span>
<span class="nc" id="L120">                map(),</span>
<span class="nc" id="L121">                map(&quot;test.histogram&quot;, histogram),</span>
<span class="nc" id="L122">                map(),</span>
<span class="nc" id="L123">                map());</span>

<span class="nc" id="L125">        assertThat(consoleOutput())</span>
<span class="nc" id="L126">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Histograms ------------------------------------------------------------------&quot;,
                        &quot;test.histogram&quot;,
                        &quot;             count = 1&quot;,
                        &quot;               min = 4&quot;,
                        &quot;               max = 2&quot;,
                        &quot;              mean = 3.00&quot;,
                        &quot;            stddev = 5.00&quot;,
                        &quot;            median = 6.00&quot;,
                        &quot;              75% &lt;= 7.00&quot;,
                        &quot;              95% &lt;= 8.00&quot;,
                        &quot;              98% &lt;= 9.00&quot;,
                        &quot;              99% &lt;= 10.00&quot;,
                        &quot;            99.9% &lt;= 11.00&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L145">    }</span>

    @Test
    public void reportsMeterValues() throws Exception {
<span class="nc" id="L149">        final Meter meter = mock(Meter.class);</span>
<span class="nc" id="L150">        when(meter.getCount()).thenReturn(1L);</span>
<span class="nc" id="L151">        when(meter.getMeanRate()).thenReturn(2.0);</span>
<span class="nc" id="L152">        when(meter.getOneMinuteRate()).thenReturn(3.0);</span>
<span class="nc" id="L153">        when(meter.getFiveMinuteRate()).thenReturn(4.0);</span>
<span class="nc" id="L154">        when(meter.getFifteenMinuteRate()).thenReturn(5.0);</span>

<span class="nc" id="L156">        reporter.report(map(),</span>
<span class="nc" id="L157">                map(),</span>
<span class="nc" id="L158">                map(),</span>
<span class="nc" id="L159">                map(&quot;test.meter&quot;, meter),</span>
<span class="nc" id="L160">                map());</span>

<span class="nc" id="L162">        assertThat(consoleOutput())</span>
<span class="nc" id="L163">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Meters ----------------------------------------------------------------------&quot;,
                        &quot;test.meter&quot;,
                        &quot;             count = 1&quot;,
                        &quot;         mean rate = 2.00 events/second&quot;,
                        &quot;     1-minute rate = 3.00 events/second&quot;,
                        &quot;     5-minute rate = 4.00 events/second&quot;,
                        &quot;    15-minute rate = 5.00 events/second&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L176">    }</span>

    @Test
    public void reportsTimerValues() throws Exception {
<span class="nc" id="L180">        final Timer timer = mock(Timer.class);</span>
<span class="nc" id="L181">        when(timer.getCount()).thenReturn(1L);</span>
<span class="nc" id="L182">        when(timer.getMeanRate()).thenReturn(2.0);</span>
<span class="nc" id="L183">        when(timer.getOneMinuteRate()).thenReturn(3.0);</span>
<span class="nc" id="L184">        when(timer.getFiveMinuteRate()).thenReturn(4.0);</span>
<span class="nc" id="L185">        when(timer.getFifteenMinuteRate()).thenReturn(5.0);</span>

<span class="nc" id="L187">        final Snapshot snapshot = mock(Snapshot.class);</span>
<span class="nc" id="L188">        when(snapshot.getMax()).thenReturn(TimeUnit.MILLISECONDS.toNanos(100));</span>
<span class="nc" id="L189">        when(snapshot.getMean()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(200));</span>
<span class="nc" id="L190">        when(snapshot.getMin()).thenReturn(TimeUnit.MILLISECONDS.toNanos(300));</span>
<span class="nc" id="L191">        when(snapshot.getStdDev()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(400));</span>
<span class="nc" id="L192">        when(snapshot.getMedian()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(500));</span>
<span class="nc" id="L193">        when(snapshot.get75thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(600));</span>
<span class="nc" id="L194">        when(snapshot.get95thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(700));</span>
<span class="nc" id="L195">        when(snapshot.get98thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(800));</span>
<span class="nc" id="L196">        when(snapshot.get99thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(900));</span>
<span class="nc" id="L197">        when(snapshot.get999thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS</span>
<span class="nc" id="L198">                .toNanos(1000));</span>

<span class="nc" id="L200">        when(timer.getSnapshot()).thenReturn(snapshot);</span>

<span class="nc" id="L202">        reporter.report(map(),</span>
<span class="nc" id="L203">                map(),</span>
<span class="nc" id="L204">                map(),</span>
<span class="nc" id="L205">                map(),</span>
<span class="nc" id="L206">                map(&quot;test.another.timer&quot;, timer));</span>

<span class="nc" id="L208">        assertThat(consoleOutput())</span>
<span class="nc" id="L209">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Timers ----------------------------------------------------------------------&quot;,
                        &quot;test.another.timer&quot;,
                        &quot;             count = 1&quot;,
                        &quot;         mean rate = 2.00 calls/second&quot;,
                        &quot;     1-minute rate = 3.00 calls/second&quot;,
                        &quot;     5-minute rate = 4.00 calls/second&quot;,
                        &quot;    15-minute rate = 5.00 calls/second&quot;,
                        &quot;               min = 300.00 milliseconds&quot;,
                        &quot;               max = 100.00 milliseconds&quot;,
                        &quot;              mean = 200.00 milliseconds&quot;,
                        &quot;            stddev = 400.00 milliseconds&quot;,
                        &quot;            median = 500.00 milliseconds&quot;,
                        &quot;              75% &lt;= 600.00 milliseconds&quot;,
                        &quot;              95% &lt;= 700.00 milliseconds&quot;,
                        &quot;              98% &lt;= 800.00 milliseconds&quot;,
                        &quot;              99% &lt;= 900.00 milliseconds&quot;,
                        &quot;            99.9% &lt;= 1000.00 milliseconds&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L232">    }</span>

    @Test
    public void reportMeterWithDisabledAttributes() throws Exception {
<span class="nc" id="L236">        Set&lt;MetricAttribute&gt; disabledMetricAttributes = EnumSet.of(MetricAttribute.M15_RATE, MetricAttribute.M5_RATE, MetricAttribute.COUNT);</span>

<span class="nc" id="L238">        final ConsoleReporter customReporter = ConsoleReporter.forRegistry(registry)</span>
<span class="nc" id="L239">                .outputTo(output)</span>
<span class="nc" id="L240">                .formattedFor(locale)</span>
<span class="nc" id="L241">                .withClock(clock)</span>
<span class="nc" id="L242">                .formattedFor(timeZone)</span>
<span class="nc" id="L243">                .convertRatesTo(TimeUnit.SECONDS)</span>
<span class="nc" id="L244">                .convertDurationsTo(TimeUnit.MILLISECONDS)</span>
<span class="nc" id="L245">                .filter(MetricFilter.ALL)</span>
<span class="nc" id="L246">                .disabledMetricAttributes(disabledMetricAttributes)</span>
<span class="nc" id="L247">                .build();</span>

<span class="nc" id="L249">        final Meter meter = mock(Meter.class);</span>
<span class="nc" id="L250">        when(meter.getCount()).thenReturn(1L);</span>
<span class="nc" id="L251">        when(meter.getMeanRate()).thenReturn(2.0);</span>
<span class="nc" id="L252">        when(meter.getOneMinuteRate()).thenReturn(3.0);</span>
<span class="nc" id="L253">        when(meter.getFiveMinuteRate()).thenReturn(4.0);</span>
<span class="nc" id="L254">        when(meter.getFifteenMinuteRate()).thenReturn(5.0);</span>

<span class="nc" id="L256">        customReporter.report(map(),</span>
<span class="nc" id="L257">                map(),</span>
<span class="nc" id="L258">                map(),</span>
<span class="nc" id="L259">                map(&quot;test.meter&quot;, meter),</span>
<span class="nc" id="L260">                map());</span>

<span class="nc" id="L262">        assertThat(consoleOutput())</span>
<span class="nc" id="L263">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Meters ----------------------------------------------------------------------&quot;,
                        &quot;test.meter&quot;,
                        &quot;         mean rate = 2.00 events/second&quot;,
                        &quot;     1-minute rate = 3.00 events/second&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L273">    }</span>

    @Test
    public void reportTimerWithDisabledAttributes() throws Exception {
<span class="nc" id="L277">        Set&lt;MetricAttribute&gt; disabledMetricAttributes = EnumSet.of(MetricAttribute.P50, MetricAttribute.P999, MetricAttribute.M5_RATE, MetricAttribute.MAX);</span>

<span class="nc" id="L279">        final ConsoleReporter customReporter = ConsoleReporter.forRegistry(registry)</span>
<span class="nc" id="L280">                .outputTo(output)</span>
<span class="nc" id="L281">                .formattedFor(locale)</span>
<span class="nc" id="L282">                .withClock(clock)</span>
<span class="nc" id="L283">                .formattedFor(timeZone)</span>
<span class="nc" id="L284">                .convertRatesTo(TimeUnit.SECONDS)</span>
<span class="nc" id="L285">                .convertDurationsTo(TimeUnit.MILLISECONDS)</span>
<span class="nc" id="L286">                .filter(MetricFilter.ALL)</span>
<span class="nc" id="L287">                .disabledMetricAttributes(disabledMetricAttributes)</span>
<span class="nc" id="L288">                .build();</span>

<span class="nc" id="L290">        final Timer timer = mock(Timer.class);</span>
<span class="nc" id="L291">        when(timer.getCount()).thenReturn(1L);</span>
<span class="nc" id="L292">        when(timer.getMeanRate()).thenReturn(2.0);</span>
<span class="nc" id="L293">        when(timer.getOneMinuteRate()).thenReturn(3.0);</span>
<span class="nc" id="L294">        when(timer.getFiveMinuteRate()).thenReturn(4.0);</span>
<span class="nc" id="L295">        when(timer.getFifteenMinuteRate()).thenReturn(5.0);</span>

<span class="nc" id="L297">        final Snapshot snapshot = mock(Snapshot.class);</span>
<span class="nc" id="L298">        when(snapshot.getMax()).thenReturn(TimeUnit.MILLISECONDS.toNanos(100));</span>
<span class="nc" id="L299">        when(snapshot.getMean()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(200));</span>
<span class="nc" id="L300">        when(snapshot.getMin()).thenReturn(TimeUnit.MILLISECONDS.toNanos(300));</span>
<span class="nc" id="L301">        when(snapshot.getStdDev()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(400));</span>
<span class="nc" id="L302">        when(snapshot.getMedian()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(500));</span>
<span class="nc" id="L303">        when(snapshot.get75thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(600));</span>
<span class="nc" id="L304">        when(snapshot.get95thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(700));</span>
<span class="nc" id="L305">        when(snapshot.get98thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(800));</span>
<span class="nc" id="L306">        when(snapshot.get99thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS.toNanos(900));</span>
<span class="nc" id="L307">        when(snapshot.get999thPercentile()).thenReturn((double) TimeUnit.MILLISECONDS</span>
<span class="nc" id="L308">                .toNanos(1000));</span>

<span class="nc" id="L310">        when(timer.getSnapshot()).thenReturn(snapshot);</span>

<span class="nc" id="L312">        customReporter.report(map(),</span>
<span class="nc" id="L313">                map(),</span>
<span class="nc" id="L314">                map(),</span>
<span class="nc" id="L315">                map(),</span>
<span class="nc" id="L316">                map(&quot;test.another.timer&quot;, timer));</span>

<span class="nc" id="L318">        assertThat(consoleOutput())</span>
<span class="nc" id="L319">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Timers ----------------------------------------------------------------------&quot;,
                        &quot;test.another.timer&quot;,
                        &quot;             count = 1&quot;,
                        &quot;         mean rate = 2.00 calls/second&quot;,
                        &quot;     1-minute rate = 3.00 calls/second&quot;,
                        &quot;    15-minute rate = 5.00 calls/second&quot;,
                        &quot;               min = 300.00 milliseconds&quot;,
                        &quot;              mean = 200.00 milliseconds&quot;,
                        &quot;            stddev = 400.00 milliseconds&quot;,
                        &quot;              75% &lt;= 600.00 milliseconds&quot;,
                        &quot;              95% &lt;= 700.00 milliseconds&quot;,
                        &quot;              98% &lt;= 800.00 milliseconds&quot;,
                        &quot;              99% &lt;= 900.00 milliseconds&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L338">    }</span>

    @Test
    public void reportHistogramWithDisabledAttributes() throws Exception {
<span class="nc" id="L342">        Set&lt;MetricAttribute&gt; disabledMetricAttributes = EnumSet.of(MetricAttribute.MIN, MetricAttribute.MAX, MetricAttribute.STDDEV, MetricAttribute.P95);</span>

<span class="nc" id="L344">        final ConsoleReporter customReporter = ConsoleReporter.forRegistry(registry)</span>
<span class="nc" id="L345">                .outputTo(output)</span>
<span class="nc" id="L346">                .formattedFor(locale)</span>
<span class="nc" id="L347">                .withClock(clock)</span>
<span class="nc" id="L348">                .formattedFor(timeZone)</span>
<span class="nc" id="L349">                .convertRatesTo(TimeUnit.SECONDS)</span>
<span class="nc" id="L350">                .convertDurationsTo(TimeUnit.MILLISECONDS)</span>
<span class="nc" id="L351">                .filter(MetricFilter.ALL)</span>
<span class="nc" id="L352">                .disabledMetricAttributes(disabledMetricAttributes)</span>
<span class="nc" id="L353">                .build();</span>

<span class="nc" id="L355">        final Histogram histogram = mock(Histogram.class);</span>
<span class="nc" id="L356">        when(histogram.getCount()).thenReturn(1L);</span>

<span class="nc" id="L358">        final Snapshot snapshot = mock(Snapshot.class);</span>
<span class="nc" id="L359">        when(snapshot.getMax()).thenReturn(2L);</span>
<span class="nc" id="L360">        when(snapshot.getMean()).thenReturn(3.0);</span>
<span class="nc" id="L361">        when(snapshot.getMin()).thenReturn(4L);</span>
<span class="nc" id="L362">        when(snapshot.getStdDev()).thenReturn(5.0);</span>
<span class="nc" id="L363">        when(snapshot.getMedian()).thenReturn(6.0);</span>
<span class="nc" id="L364">        when(snapshot.get75thPercentile()).thenReturn(7.0);</span>
<span class="nc" id="L365">        when(snapshot.get95thPercentile()).thenReturn(8.0);</span>
<span class="nc" id="L366">        when(snapshot.get98thPercentile()).thenReturn(9.0);</span>
<span class="nc" id="L367">        when(snapshot.get99thPercentile()).thenReturn(10.0);</span>
<span class="nc" id="L368">        when(snapshot.get999thPercentile()).thenReturn(11.0);</span>

<span class="nc" id="L370">        when(histogram.getSnapshot()).thenReturn(snapshot);</span>

<span class="nc" id="L372">        customReporter.report(map(),</span>
<span class="nc" id="L373">                map(),</span>
<span class="nc" id="L374">                map(&quot;test.histogram&quot;, histogram),</span>
<span class="nc" id="L375">                map(),</span>
<span class="nc" id="L376">                map());</span>

<span class="nc" id="L378">        assertThat(consoleOutput())</span>
<span class="nc" id="L379">                .isEqualTo(lines(</span>
                        dateHeader,
                        &quot;&quot;,
                        &quot;-- Histograms ------------------------------------------------------------------&quot;,
                        &quot;test.histogram&quot;,
                        &quot;             count = 1&quot;,
                        &quot;              mean = 3.00&quot;,
                        &quot;            median = 6.00&quot;,
                        &quot;              75% &lt;= 7.00&quot;,
                        &quot;              98% &lt;= 9.00&quot;,
                        &quot;              99% &lt;= 10.00&quot;,
                        &quot;            99.9% &lt;= 11.00&quot;,
                        &quot;&quot;,
                        &quot;&quot;
                ));
<span class="nc" id="L394">    }</span>

    private String lines(String... lines) {
<span class="nc" id="L397">        final StringBuilder builder = new StringBuilder();</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">        for (String line : lines) {</span>
<span class="nc" id="L399">            builder.append(line).append(String.format(&quot;%n&quot;));</span>
        }
<span class="nc" id="L401">        return builder.toString();</span>
    }

    private String consoleOutput() throws UnsupportedEncodingException {
<span class="nc" id="L405">        return bytes.toString(&quot;UTF-8&quot;);</span>
    }

    private &lt;T&gt; SortedMap&lt;String, T&gt; map() {
<span class="nc" id="L409">        return new TreeMap&lt;&gt;();</span>
    }

    private &lt;T&gt; SortedMap&lt;String, T&gt; map(String name, T metric) {
<span class="nc" id="L413">        final TreeMap&lt;String, T&gt; map = new TreeMap&lt;&gt;();</span>
<span class="nc" id="L414">        map.put(name, metric);</span>
<span class="nc" id="L415">        return map;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>